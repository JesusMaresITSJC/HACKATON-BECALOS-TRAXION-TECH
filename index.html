<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Sistema de Mantenimiento Preventivo</title>
    
</head>
<body>

    <div class="container">
        <!-- Formulario -->
        <div id="formulario">
            <h1>ğŸ”§ Sistema de Mantenimiento Preventivo ğŸ”§</h1>
            <p class="subtitle">EvaluaciÃ³n de riesgo mecÃ¡nico basado en seÃ±ales tempranas - Grupo TRAXION</p>
            
            <form id="formMantenimiento">
                <div class="form-group">
                    <label for="Idvehiculo">MatrÃ­cula del VehÃ­culo:</label>
                    <input type="text" id="Idvehiculo" required placeholder="Ej: M3V56G">
                </div>
                                
                <div class="form-group">
                    <label for="kmActuales">KilÃ³metros actuales:</label>
                    <input type="number" id="kmActuales" required min="0" placeholder="Ej: 45000">
                </div>

                <div class="form-group">
                    <label for="kmUltimoServicio">KilÃ³metros del Ãºltimo servicio:</label>
                    <input type="number" id="kmUltimoServicio" required min="0" placeholder="Ej: 40000">
                </div>

                <div class="form-group">
                    <label>Â¿Presenta cÃ³digos de falla?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="fallasSi" name="fallas" value="si" required>
                            <label for="fallasSi">SÃ­</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="fallasNo" name="fallas" value="no">
                            <label for="fallasNo">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Â¿ConducciÃ³n a exceso de velocidad?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="velocidadSi" name="velocidad" value="si" required>
                            <label for="velocidadSi">SÃ­</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="velocidadNo" name="velocidad" value="no">
                            <label for="velocidadNo">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Â¿Frenadas bruscas frecuentes?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="frenadasSi" name="frenadas" value="si" required>
                            <label for="frenadasSi">SÃ­</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="frenadasNo" name="frenadas" value="no">
                            <label for="frenadasNo">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="hServicio">Horas de operaciÃ³n diarias:</label>
                    <input type="number" id="hServicio" required min="0" max="24" placeholder="Ej: 8">
                </div>

                <div class="form-group">
                    <label for="tipoOperacion">Tipo de operaciÃ³n:</label>
                    <select id="tipoOperacion" required>
                        <option value="">Seleccione...</option>
                        <option value="urbana">Urbana (ciudad)</option>
                        <option value="carretera">Carretera</option>
                        <option value="mixta">Mixta</option>
                        <option value="severa">Severa (carga pesada/terreno difÃ­cil)</option>
                    </select>
                </div>

                <button type="submit">Evaluar Riesgo</button>
            </form>
        </div>

        <!-- Pantalla 2: Resultado -->
        <div id="resultado" class="hidden resultado">
            <h1>ğŸ“Š Resultado de EvaluaciÃ³n</h1>
            <p class="subtitle">VehÃ­culo: <span id="mostrarMatricula"></span></p>
            
            <div class="semaforo" id="semaforo">ğŸŸ¢</div>
            
            <div class="riesgo-nivel" id="nivelRiesgo">Riesgo: BAJO</div>
            
            <div class="explicacion">
                <h3>AnÃ¡lisis de factores:</h3>
                <ul id="listaFactores"></ul>
                <p style="margin-top: 15px; font-weight: bold;" id="puntuacionTotal"></p>
            </div>

            <div class="accion">
                <h3>ğŸ¯ Acciones recomendadas:</h3>
                <p id="accionTexto"></p>
            </div>

            <button class="btn-volver" onclick="volverFormulario()">â† Nueva EvaluaciÃ³n</button>
        </div>
    </div>

    <script>
        document.getElementById('formMantenimiento').addEventListener('submit', function(e) {
            e.preventDefault();
            calcularRiesgo();
        });

        function calcularRiesgo() {
            // Obtener valores
            const matricula = document.getElementById('Idvehiculo').value;
            const kmActuales = parseInt(document.getElementById('kmActuales').value);
            const kmUltimoServicio = parseInt(document.getElementById('kmUltimoServicio').value);
            const tieneFallas = document.querySelector('input[name="fallas"]:checked').value;
            const excesoDeVelocidad = document.querySelector('input[name="velocidad"]:checked').value;
            const frenadasBruscas = document.querySelector('input[name="frenadas"]:checked').value;
            const hServicio = parseInt(document.getElementById('hServicio').value);
            const tipoOperacion = document.getElementById('tipoOperacion').value;

            let puntuacion = 0;
            let factores = [];

            // Factor 1: KilÃ³metros desde Ãºltimo servicio
            const kmDesdeServicio = kmActuales - kmUltimoServicio;
            if (kmDesdeServicio > 10000) {
                puntuacion += 30;
                factores.push(`Km desde Ãºltimo servicio: ${kmDesdeServicio.toLocaleString()} km - Excede intervalo recomendado`);
            } else if (kmDesdeServicio > 5000) {
                puntuacion += 15;
                factores.push(`Km desde Ãºltimo servicio: ${kmDesdeServicio.toLocaleString()} km - PrÃ³ximo a mantenimiento`);
            } else {
                factores.push(`Km desde Ãºltimo servicio: ${kmDesdeServicio.toLocaleString()} km - Dentro del rango`);
            }

            // Factor 2: CÃ³digos de falla
            if (tieneFallas === 'si') {
                puntuacion += 35;
                factores.push('CÃ³digos de falla detectados - Requiere diagnÃ³stico');
            } else {
                factores.push('Sin cÃ³digos de falla');
            }

            // Factor 3: ConducciÃ³n a exceso de velocidad
            if (excesoDeVelocidad === 'si') {
                puntuacion += 20;
                factores.push('ConducciÃ³n a exceso de velocidad - Acelera desgaste');
            } else {
                factores.push('Velocidad de conducciÃ³n normal');
            }

            // Factor 4: Frenadas bruscas
            if (frenadasBruscas === 'si') {
                puntuacion += 20;
                factores.push('Frenadas bruscas frecuentes - Acelera desgaste en frenos');
            } else {
                factores.push('Frenado normal');
            }

            // Factor 5: Horas activas de servicio
            if (hServicio > 8) {
                puntuacion += 30;
                factores.push(`Horas activas: ${hServicio} hrs/dÃ­a - Excede intervalo recomendado`);
            } else {
                factores.push(`Horas activas: ${hServicio} hrs/dÃ­a - Dentro del rango`);
            }

            // Factor 6: Tipo de operaciÃ³n
            switch(tipoOperacion) {
                case 'severa':
                    puntuacion += 25;
                    factores.push('OperaciÃ³n severa - Alto desgaste de componentes');
                    break;
                case 'mixta':
                    puntuacion += 15;
                    factores.push('OperaciÃ³n mixta - Desgaste moderado');
                    break;
                case 'urbana':
                    puntuacion += 10;
                    factores.push('OperaciÃ³n urbana - Desgaste por arranques frecuentes');
                    break;
                case 'carretera':
                    puntuacion += 5;
                    factores.push('OperaciÃ³n en carretera - Desgaste uniforme');
                    break;
            }

            // Determinar nivel de riesgo
            let nivel, semaforo, accion;
            
            if (puntuacion >= 100) {
                nivel = 'ALTO';
                semaforo = 'ğŸ”´';
                accion = 'INTERVENIR INMEDIATAMENTE: Programar inspecciÃ³n tÃ©cnica urgente. La unidad presenta mÃºltiples seÃ±ales de riesgo que podrÃ­an derivar en falla mecÃ¡nica. Detener operaciÃ³n si es posible hasta revisiÃ³n.';
            } else if (puntuacion >= 50) {
                nivel = 'MEDIO';
                semaforo = 'ğŸŸ¡';
                accion = 'REVISAR PRÃ“XIMAMENTE: Agendar inspecciÃ³n preventiva en los prÃ³ximos 7 dÃ­as. Monitorear seÃ±ales de alerta y ajustar plan de mantenimiento segÃºn hallazgos.';
            } else {
                nivel = 'BAJO';
                semaforo = 'ğŸŸ¢';
                accion = 'MANTENER MONITOREO: La unidad estÃ¡ en condiciones normales. Continuar con plan de mantenimiento programado. Realizar prÃ³xima revisiÃ³n segÃºn calendario establecido. Puedes revisar otros aspectos de la unidad para su buen funcionamiento como: Aire de los neumaticos, nivel de aceite, nivel de liquido de frenos, etc.';
            }

            // Mostrar resultado
            document.getElementById('mostrarMatricula').textContent = matricula.toUpperCase();
            document.getElementById('semaforo').textContent = semaforo;
            document.getElementById('nivelRiesgo').textContent = `Riesgo: ${nivel}`;
            document.getElementById('nivelRiesgo').className = `riesgo-nivel riesgo-${nivel.toLowerCase()}`;
            document.getElementById('puntuacionTotal').textContent = `PuntuaciÃ³n total de riesgo: ${puntuacion} / 170 puntos`;
            document.getElementById('accionTexto').textContent = accion;

            // Mostrar factores
            const listaFactores = document.getElementById('listaFactores');
            listaFactores.innerHTML = '';
            factores.forEach(factor => {
                const li = document.createElement('li');
                li.textContent = factor;
                listaFactores.appendChild(li);
            });

            // Cambiar pantalla
            document.getElementById('formulario').classList.add('hidden');
            document.getElementById('resultado').classList.remove('hidden');
        }

        function volverFormulario() {
            document.getElementById('resultado').classList.add('hidden');
            document.getElementById('formulario').classList.remove('hidden');
            document.getElementById('formMantenimiento').reset();
        }
    </script>

    <!-- ===============================
     ASISTENTE IA TRAxIBOT
=============================== -->

<input type="checkbox" id="chat-toggle">

<label for="chat-toggle" class="chat-btn" title="Asistente de Mantenimiento">
    ğŸš›
</label>

<div class="chat-box">
    <div class="chat-header">
        TraxiBot ğŸ¤–ğŸš›
    </div>

    <div class="chat-body">
        <div class="bot-msg">
            Â¡Hola! Soy <strong>TraxiBot</strong>, el asistente del sistema de mantenimiento preventivo.
        </div>

        <div class="bot-msg">
            Mi funciÃ³n es ayudarte a entender cuÃ¡ndo y por quÃ© una unidad requiere mantenimiento.
        </div>

        <div class="options">
            <input type="radio" name="chatbot" id="opt1">
            <label for="opt1">Â¿Por quÃ© es importante el mantenimiento?</label>

            <input type="radio" name="chatbot" id="opt2">
            <label for="opt2">Â¿QuÃ© analiza este sistema?</label>

            <input type="radio" name="chatbot" id="opt3">
            <label for="opt3">Â¿QuÃ© beneficios tiene para TRAXION?</label>

            <div class="response resp1 bot-msg">
                El mantenimiento preventivo evita fallas mecÃ¡nicas, reduce accidentes,
                prolonga la vida Ãºtil del vehÃ­culo y disminuye costos operativos.
            </div>

            <div class="response resp2 bot-msg">
                Analiza kilÃ³metros recorridos, hÃ¡bitos de conducciÃ³n,
                horas de operaciÃ³n, tipo de servicio y seÃ±ales de desgaste mecÃ¡nico.
            </div>

            <div class="response resp3 bot-msg">
                Permite tomar decisiones oportunas, reducir paros inesperados,
                optimizar recursos y garantizar una flota mÃ¡s segura y eficiente.
            </div>
        </div>
    </div>
</div>

</body>
</html> 