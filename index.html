<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Sistema de Mantenimiento Preventivo</title>
    
</head>
<body>
    <div class="container">
        <!-- Formulario -->
        <div id="formulario">
            <h1>üîß Sistema de Mantenimiento Preventivo üîß</h1>
            <p class="subtitle">Evaluaci√≥n de riesgo mec√°nico basado en se√±ales tempranas - Grupo TRAXION</p>
            
            <form id="formMantenimiento">
                <div class="form-group">
                    <label for="Idvehiculo">Matr√≠cula del Veh√≠culo:</label>
                    <input type="text" id="Idvehiculo" required placeholder="Ej: M3V56G">
                </div>
                                
                <div class="form-group">
                    <label for="kmActuales">Kil√≥metros actuales:</label>
                    <input type="number" id="kmActuales" required min="0" placeholder="Ej: 45000">
                </div>

                <div class="form-group">
                    <label for="kmUltimoServicio">Kil√≥metros del √∫ltimo servicio:</label>
                    <input type="number" id="kmUltimoServicio" required min="0" placeholder="Ej: 40000">
                </div>

                <div class="form-group">
                    <label>¬øPresenta c√≥digos de falla?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="fallasSi" name="fallas" value="si" required>
                            <label for="fallasSi">S√≠</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="fallasNo" name="fallas" value="no">
                            <label for="fallasNo">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>¬øConducci√≥n a exceso de velocidad?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="velocidadSi" name="velocidad" value="si" required>
                            <label for="velocidadSi">S√≠</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="velocidadNo" name="velocidad" value="no">
                            <label for="velocidadNo">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>¬øFrenadas bruscas frecuentes?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="frenadasSi" name="frenadas" value="si" required>
                            <label for="frenadasSi">S√≠</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="frenadasNo" name="frenadas" value="no">
                            <label for="frenadasNo">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="hServicio">Horas de operaci√≥n diarias:</label>
                    <input type="number" id="hServicio" required min="0" max="24" placeholder="Ej: 8">
                </div>

                <div class="form-group">
                    <label for="tipoOperacion">Tipo de operaci√≥n:</label>
                    <select id="tipoOperacion" required>
                        <option value="">Seleccione...</option>
                        <option value="urbana">Urbana (ciudad)</option>
                        <option value="carretera">Carretera</option>
                        <option value="mixta">Mixta</option>
                        <option value="severa">Severa (carga pesada/terreno dif√≠cil)</option>
                    </select>
                </div>

                <button type="submit">Evaluar Riesgo</button>
            </form>
        </div>

        <!-- Pantalla 2: Resultado -->
        <div id="resultado" class="hidden resultado">
            <h1>üìä Resultado de Evaluaci√≥n</h1>
            <p class="subtitle">Veh√≠culo: <span id="mostrarMatricula"></span></p>
            
            <div class="semaforo" id="semaforo">üü¢</div>
            
            <div class="riesgo-nivel" id="nivelRiesgo">Riesgo: BAJO</div>
            
            <div class="explicacion">
                <h3>An√°lisis de factores:</h3>
                <ul id="listaFactores"></ul>
                <p style="margin-top: 15px; font-weight: bold;" id="puntuacionTotal"></p>
            </div>

            <div class="accion">
                <h3>üéØ Acciones recomendadas:</h3>
                <p id="accionTexto"></p>
            </div>

            <button class="btn-volver" onclick="volverFormulario()">‚Üê Nueva Evaluaci√≥n</button>
        </div>
    </div>

    <script>
        document.getElementById('formMantenimiento').addEventListener('submit', function(e) {
            e.preventDefault();
            calcularRiesgo();
        });

        function calcularRiesgo() {
            // Obtener valores
            const matricula = document.getElementById('Idvehiculo').value;
            const kmActuales = parseInt(document.getElementById('kmActuales').value);
            const kmUltimoServicio = parseInt(document.getElementById('kmUltimoServicio').value);
            const tieneFallas = document.querySelector('input[name="fallas"]:checked').value;
            const excesoDeVelocidad = document.querySelector('input[name="velocidad"]:checked').value;
            const frenadasBruscas = document.querySelector('input[name="frenadas"]:checked').value;
            const hServicio = parseInt(document.getElementById('hServicio').value);
            const tipoOperacion = document.getElementById('tipoOperacion').value;

            let puntuacion = 0;
            let factores = [];

            // Factor 1: Kil√≥metros desde √∫ltimo servicio
            const kmDesdeServicio = kmActuales - kmUltimoServicio;
            if (kmDesdeServicio > 10000) {
                puntuacion += 30;
                factores.push(`Km desde √∫ltimo servicio: ${kmDesdeServicio.toLocaleString()} km - Excede intervalo recomendado`);
            } else if (kmDesdeServicio > 5000) {
                puntuacion += 15;
                factores.push(`Km desde √∫ltimo servicio: ${kmDesdeServicio.toLocaleString()} km - Pr√≥ximo a mantenimiento`);
            } else {
                factores.push(`Km desde √∫ltimo servicio: ${kmDesdeServicio.toLocaleString()} km - Dentro del rango`);
            }

            // Factor 2: C√≥digos de falla
            if (tieneFallas === 'si') {
                puntuacion += 35;
                factores.push('C√≥digos de falla detectados - Requiere diagn√≥stico');
            } else {
                factores.push('Sin c√≥digos de falla');
            }

            // Factor 3: Conducci√≥n a exceso de velocidad
            if (excesoDeVelocidad === 'si') {
                puntuacion += 20;
                factores.push('Conducci√≥n a exceso de velocidad - Acelera desgaste');
            } else {
                factores.push('Velocidad de conducci√≥n normal');
            }

            // Factor 4: Frenadas bruscas
            if (frenadasBruscas === 'si') {
                puntuacion += 20;
                factores.push('Frenadas bruscas frecuentes - Acelera desgaste en frenos');
            } else {
                factores.push('Frenado normal');
            }

            // Factor 5: Horas activas de servicio
            if (hServicio > 8) {
                puntuacion += 30;
                factores.push(`Horas activas: ${hServicio} hrs/d√≠a - Excede intervalo recomendado`);
            } else {
                factores.push(`Horas activas: ${hServicio} hrs/d√≠a - Dentro del rango`);
            }

            // Factor 6: Tipo de operaci√≥n
            switch(tipoOperacion) {
                case 'severa':
                    puntuacion += 25;
                    factores.push('Operaci√≥n severa - Alto desgaste de componentes');
                    break;
                case 'mixta':
                    puntuacion += 15;
                    factores.push('Operaci√≥n mixta - Desgaste moderado');
                    break;
                case 'urbana':
                    puntuacion += 10;
                    factores.push('Operaci√≥n urbana - Desgaste por arranques frecuentes');
                    break;
                case 'carretera':
                    puntuacion += 5;
                    factores.push('Operaci√≥n en carretera - Desgaste uniforme');
                    break;
            }

            // Determinar nivel de riesgo
            let nivel, semaforo, accion;
            
            if (puntuacion >= 100) {
                nivel = 'ALTO';
                semaforo = 'üî¥';
                accion = 'INTERVENIR INMEDIATAMENTE: Programar inspecci√≥n t√©cnica urgente. La unidad presenta m√∫ltiples se√±ales de riesgo que podr√≠an derivar en falla mec√°nica. Detener operaci√≥n si es posible hasta revisi√≥n.';
            } else if (puntuacion >= 50) {
                nivel = 'MEDIO';
                semaforo = 'üü°';
                accion = 'REVISAR PR√ìXIMAMENTE: Agendar inspecci√≥n preventiva en los pr√≥ximos 7 d√≠as. Monitorear se√±ales de alerta y ajustar plan de mantenimiento seg√∫n hallazgos.';
            } else {
                nivel = 'BAJO';
                semaforo = 'üü¢';
                accion = 'MANTENER MONITOREO: La unidad est√° en condiciones normales. Continuar con plan de mantenimiento programado. Realizar pr√≥xima revisi√≥n seg√∫n calendario establecido. Puedes revisar otros aspectos de la unidad para su buen funcionamiento como: Aire de los neumaticos, nivel de aceite, nivel de liquido de frenos, etc.';
            }

            // Mostrar resultado
            document.getElementById('mostrarMatricula').textContent = matricula.toUpperCase();
            document.getElementById('semaforo').textContent = semaforo;
            document.getElementById('nivelRiesgo').textContent = `Riesgo: ${nivel}`;
            document.getElementById('nivelRiesgo').className = `riesgo-nivel riesgo-${nivel.toLowerCase()}`;
            document.getElementById('puntuacionTotal').textContent = `Puntuaci√≥n total de riesgo: ${puntuacion} / 170 puntos`;
            document.getElementById('accionTexto').textContent = accion;

            // Mostrar factores
            const listaFactores = document.getElementById('listaFactores');
            listaFactores.innerHTML = '';
            factores.forEach(factor => {
                const li = document.createElement('li');
                li.textContent = factor;
                listaFactores.appendChild(li);
            });

            // Cambiar pantalla
            document.getElementById('formulario').classList.add('hidden');
            document.getElementById('resultado').classList.remove('hidden');
        }

        function volverFormulario() {
            document.getElementById('resultado').classList.add('hidden');
            document.getElementById('formulario').classList.remove('hidden');
            document.getElementById('formMantenimiento').reset();
        }
    </script>
</body>
</html>